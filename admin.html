<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin – Verify Teachers</title>

  <style>
    * { box-sizing: border-box; font-family: Poppins; }
    body {
      background: linear-gradient(135deg, #9be15d, #00e3ae);
      padding: 20px; margin: 0;
    }
    h1 { text-align: center; color: #2e7d32; }
    .teacher-list {
      max-width: 700px; margin: auto;
      background: white; padding: 20px; border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1)
    }
    .card {
      padding: 15px; border-radius: 10px;
      background: #e8f5e9; margin-bottom: 10px;
      display: flex; justify-content: space-between;
    }
    .verified { background: #81c784 !important; color: white; }
    button {
      background: #2e7d32; border: none;
      color: white; padding: 8px 12px;
      border-radius: 8px; cursor: pointer;
    }
    .logout { margin-top: 20px; display: block; width: 120px; margin-left: auto; margin-right: auto; }
  </style>
</head>
<body>

<h1>Admin Panel – Verify Teachers</h1>

<div class="teacher-list" id="list">Loading...</div>
<button class="logout" id="logout">Log Out</button>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  import { getFirestore, getDocs, collection, updateDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAvblGiAIZ26bIbtw6cSv9kfgzSiYyq_10",
    authDomain: "registar-5f3fb.firebaseapp.com",
    projectId: "registar-5f3fb",
    storageBucket: "registar-5f3fb.firebasestorage.app",
    messagingSenderId: "856198150739",
    appId: "1:856198150739:web:801000f564b47f6333e4a6"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const ADMIN_EMAIL = "YOUR_ADMIN_EMAIL_HERE";

  onAuthStateChanged(auth, (user) => {
    if (!user || user.email !== ADMIN_EMAIL) {
      alert("Unauthorized.");
      return window.location = "index.html";
    }
    loadTeachers();
  });

  async function loadTeachers() {
    const q = await getDocs(collection(db, "teachers"));
    const list = document.getElementById("list");
    list.innerHTML = "";

    q.forEach(docSnap => {
      const t = docSnap.data();
      const div = document.createElement("div");
      div.className = "card" + (t.verified ? " verified" : "");
      div.innerHTML = `
        <div>
          <b>${t.name}</b><br>
          Grade ${t.grade} – ${t.section}<br>
          ${t.email}
        </div>
        <button ${t.verified ? "disabled" : ""} data-id="${docSnap.id}">
          ${t.verified ? "Verified" : "Verify"}
        </button>
      `;
      list.appendChild(div);
    });

    document.querySelectorAll("button[data-id]").forEach(btn => {
      btn.onclick = async () => {
        await updateDoc(doc(db, "teachers", btn.dataset.id), { verified: true });
        btn.innerText = "Verified";
        btn.disabled = true;
        btn.parentElement.classList.add("verified");
      };
    });
  }

  document.getElementById("logout").onclick = () => {
    signOut(auth);
    window.location = "index.html";
  };
</script>

</body>
</html>
